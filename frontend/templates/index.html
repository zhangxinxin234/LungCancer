<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>肺癌中医诊疗智能辅助系统</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .prescription-content {
            white-space: pre-line;
            font-family: "SimSun", serif;
            line-height: 2;
        }
        .medicine-content {
            white-space: pre-line;
            font-family: "SimSun", serif;
            line-height: 2;
        }
        .guideline-content {
            white-space: pre-line;
            font-family: "SimSun", serif;
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container">
            <a class="navbar-brand" href="#">肺癌中医诊疗智能辅助系统</a>
        </div>
    </nav>

    <div class="container mt-4">
        <div class="row">
            <div class="col-md-4">
                <div class="card">
                    <div class="card-header">
                        <h5 class="card-title">患者列表</h5>
                    </div>
                    <div class="card-body">
                        <button class="btn btn-primary mb-3" onclick="createNewPatient()">新建患者</button>
                        <div id="patientList"></div>
                    </div>
                </div>
            </div>
            <div class="col-md-8">
                <div class="card">
                    <div class="card-header">
                        <h5 class="card-title">患者信息</h5>
                    </div>
                    <div class="card-body">
                        <form id="patientForm">
                            <div class="mb-3">
                                <label class="form-label">西医诊断</label>
                                <input type="text" class="form-control" name="diagnosis" value="左肺腺癌术后1年1个月，化疗后">
                            </div>
                            <div class="mb-3">
                                <label class="form-label">现病程阶段</label>
                                <input type="text" class="form-control" name="disease_stage" value="靶向治疗">
                            </div>
                            <div class="mb-3">
                                <label class="form-label">病理报告</label>
                                <textarea class="form-control" name="pathology_report" rows="3">21-12月因头疼检查 CT，发现左侧小脑占位；左肺上叶段占位，后于 22-1 月头部行手术切除内颅内肿物，病理:左肺腺癌，脑转移。免疫组化: CK7(-)，CK20(散在少许阳性)，KI-67(约 90%)，TTF-1(-)。 NapsinA(-)，CDX2(+)，GATA3(-),CK(+)，CK8/18(+)，CEA(+)。 基因检测 kars G12c 突变。</textarea>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">分期</label>
                                <input type="text" class="form-control" name="staging" value="IB">
                            </div>
                            <div class="mb-3">
                                <label class="form-label">TNM分期</label>
                                <input type="text" class="form-control" name="tnm_staging" value="T2aN0">
                            </div>
                            <div class="mb-3">
                                <label class="form-label">实验室检查</label>
                                <textarea class="form-control" name="lab_tests" rows="3">22-6-21 血常规: WBC12.3↑，RBC3.29↓,HGB 85↓，PLT512↑，LY 0.65↓。 生化:肌酐139.1↑，碱性磷酸酶 765↑，谷氨酸转肤酶 312.9↑，谷丙 70↑，谷草 50.6↑，尿素 12.7↑。 肿标: CA199 313.29↑，NSE 45.42↑，CEA 121.58↑。</textarea>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">影像学报告</label>
                                <textarea class="form-control" name="imaging_report" rows="3">22-6-21CT:左肺上叶占位63*56mm; 两肺另见多发小结节，部分为磨玻璃结节 10mm; 纵膈淋巴结 18mm; 右肾上腺肿物 39*24mm;骨转移较前进展。</textarea>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">症状</label>
                                <textarea class="form-control" name="symptoms" rows="3">便秘，乏力，纳食差</textarea>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">舌苔</label>
                                <input type="text" class="form-control" name="tongue" value="舌红苔白">
                            </div>
                            <div class="mb-3">
                                <label class="form-label">脉象</label>
                                <input type="text" class="form-control" name="pulse" value="沉细">
                            </div>
                            <button type="submit" class="btn btn-primary">提交</button>
                            <button type="button" class="btn btn-success ms-2" onclick="generatePrescription()">生成处方</button>
                        </form>
                    </div>
                </div>

                <div class="card mt-4" id="prescriptionCard" style="display: none;">
                    <div class="card-header">
                        <h5 class="card-title">处方信息</h5>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <h6>西医诊疗分期</h6>
                            <p id="westernTreatmentStage" class="prescription-content"></p>
                        </div>
                        <div class="mb-3">
                            <h6>CSCO指南</h6>
                            <div id="cscoGuideline" class="guideline-content"></div>
                        </div>
                        <div class="mb-3">
                            <h6>处方</h6>
                            <p id="prescription" class="prescription-content"></p>
                        </div>
                        <div class="mb-3">
                            <h6>中成药</h6>
                            <p id="medicine" class="medicine-content"></p>
                        </div>
                        <div class="mb-3">
                            <h6>修复建议</h6>
                            <textarea class="form-control" id="repairRules" rows="3"></textarea>
                        </div>
                        <button class="btn btn-warning" onclick="repairPrescription()">修复处方</button>
                        <button class="btn btn-success ms-2" onclick="adoptRepair()">采纳修复</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>
</html> 